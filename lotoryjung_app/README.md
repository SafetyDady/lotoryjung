# ğŸ° Lotoryjung - Advanced Lottery Management System

à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸¥à¸­à¸•à¹€à¸•à¸­à¸£à¸µà¹ˆà¸—à¸µà¹ˆà¸„à¸£à¸šà¸„à¸£à¸±à¸™à¸”à¹‰à¸§à¸¢ Flask framework à¸à¸£à¹‰à¸­à¸¡à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¸‚à¸±à¹‰à¸™à¸ªà¸¹à¸‡à¹à¸¥à¸°à¸à¸²à¸£à¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸¥à¸‚à¸­à¸±à¹‰à¸™

## ğŸš€ Features Overview

### ğŸ¯ Core Functionality
- **User Authentication System** - à¸£à¸°à¸šà¸šà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹à¸¥à¸°à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š
- **Order Management** - à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸¥à¸­à¸•à¹€à¸•à¸­à¸£à¸µà¹ˆ
- **Admin Dashboard** - à¹à¸”à¸Šà¸šà¸­à¸£à¹Œà¸”à¸ªà¸³à¸«à¸£à¸±à¸šà¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥à¸£à¸°à¸šà¸š
- **Audit Logging** - à¸šà¸±à¸™à¸—à¸¶à¸à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡à¸£à¸°à¸šà¸š

### ğŸ”’ Blocked Numbers Management
- **Bulk Operations** - à¹€à¸à¸´à¹ˆà¸¡à¹€à¸¥à¸‚à¸­à¸±à¹‰à¸™à¸«à¸¥à¸²à¸¢à¸•à¸±à¸§à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™
- **Auto-detection** - à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸¥à¸‚à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸•à¸²à¸¡à¸„à¸§à¸²à¸¡à¸¢à¸²à¸§
- **Permutation Generation** - à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸¥à¸‚à¸ªà¸¥à¸±à¸šà¸—à¸µà¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
- **Advanced Search & Filter** - à¸„à¹‰à¸™à¸«à¸²à¹à¸¥à¸°à¸à¸£à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸±à¹‰à¸™à¸ªà¸¹à¸‡

### ğŸ“Š Limits Management System

#### Group Limits (à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¸à¸¥à¸¸à¹ˆà¸¡)
- **Default Limits Setting** - à¸à¸³à¸«à¸™à¸”à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸ªà¸³à¸«à¸£à¸±à¸šà¹à¸•à¹ˆà¸¥à¸°à¸›à¸£à¸°à¹€à¸ à¸—
- **Real-time Usage Tracking** - à¸•à¸´à¸”à¸•à¸²à¸¡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ
- **Visual Progress Bars** - à¹à¸ªà¸”à¸‡à¸œà¸¥à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸”à¹‰à¸§à¸¢à¸à¸£à¸²à¸Ÿà¹à¸—à¹ˆà¸‡
- **Automated Limit Validation** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´

#### Individual Number Limits (à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹€à¸¥à¸‚à¹à¸•à¹ˆà¸¥à¸°à¸•à¸±à¸§) â­
- **Granular Control** - à¸„à¸§à¸šà¸„à¸¸à¸¡à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹€à¸‰à¸à¸²à¸°à¹€à¸¥à¸‚à¹à¸•à¹ˆà¸¥à¸°à¸•à¸±à¸§
- **Priority-based Validation** - à¸£à¸°à¸šà¸šà¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¸ªà¸³à¸„à¸±à¸
- **CRUD Operations** - à¹€à¸à¸´à¹ˆà¸¡/à¹à¸à¹‰à¹„à¸‚/à¸¥à¸š à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹€à¸‰à¸à¸²à¸°à¹€à¸¥à¸‚
- **Override Default Limits** - à¹à¸—à¸™à¸—à¸µà¹ˆà¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹„à¸”à¹‰

### ï¿½ï¸ Bulk Order Form System (NEW) â­
- **Multi-row Orders** - à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸«à¸¥à¸²à¸¢à¸£à¸²à¸¢à¸à¸²à¸£à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™ (à¸ªà¸¹à¸‡à¸ªà¸¸à¸” 20 à¸šà¸£à¸£à¸—à¸±à¸”)
- **2-Step Validation** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸²à¸¢à¸šà¸£à¸£à¸—à¸±à¸” à¹à¸¥à¸° à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
- **Field Restrictions** - 
  - à¹€à¸¥à¸‚ 2 à¸•à¸±à¸§: à¸‹à¸·à¹‰à¸­ "à¸šà¸™" à¹à¸¥à¸° "à¸¥à¹ˆà¸²à¸‡" à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
  - à¹€à¸¥à¸‚ 3 à¸•à¸±à¸§: à¸‹à¸·à¹‰à¸­ "3 à¸•à¸±à¸§à¸šà¸™" à¹à¸¥à¸° "à¹‚à¸•à¹Šà¸”" à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- **Real-time Field Validation** - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¹ƒà¸ªà¹ˆà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸´à¸”à¸›à¸£à¸°à¹€à¸ à¸—
- **Dynamic Payout Display** - à¹à¸ªà¸”à¸‡à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢à¸«à¸¥à¸±à¸‡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š

### ğŸ’¾ Database-Driven Payout System (NEW) â­
- **Dynamic Payout Rates** - à¸”à¸¶à¸‡à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢à¸ˆà¸²à¸à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
- **External Calculation Support** - à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸ˆà¸²à¸à¸£à¸°à¸šà¸šà¸ à¸²à¸¢à¸™à¸­à¸
- **Validation Factors** - à¸šà¸±à¸™à¸—à¸¶à¸à¸›à¸±à¸ˆà¸ˆà¸±à¸¢à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š (1.0x à¸«à¸£à¸·à¸­ 0.5x)
- **Message Text Updates** - à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸•à¸·à¸­à¸™ "à¸¡à¸µà¸¢à¸­à¸”à¸‹à¸·à¹‰à¸­à¹€à¸à¸´à¸™à¹‚à¸„à¸§à¸•à¹‰à¸²"

### ï¿½ğŸ›¡ï¸ Security Features
- **CSRF Protection** - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¹‚à¸ˆà¸¡à¸•à¸µ Cross-Site Request Forgery
- **Admin Authorization** - à¸£à¸°à¸šà¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥à¸£à¸°à¸šà¸š
- **Input Validation** - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸³à¹€à¸‚à¹‰à¸²à¸—à¸¸à¸à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™
- **SQL Injection Prevention** - à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¹‚à¸ˆà¸¡à¸•à¸µ SQL Injection

## ğŸ—ï¸ System Architecture

### ğŸ“‹ Validation Priority Logic
```
Priority 1: Blocked Numbers Check
    â”œâ”€â”€ If blocked â†’ 0.5x payout rate, message: "à¹€à¸¥à¸‚à¸­à¸±à¹‰à¸™"
    â””â”€â”€ If not blocked â†’ Continue

Priority 2: Individual Limits Check  
    â”œâ”€â”€ If individual limit exists â†’ Use individual limit
    â”‚   â”œâ”€â”€ If over limit â†’ 0.5x payout rate, message: "à¸¡à¸µà¸¢à¸­à¸”à¸‹à¸·à¹‰à¸­à¹€à¸à¸´à¸™à¹‚à¸„à¸§à¸•à¹‰à¸²"
    â”‚   â””â”€â”€ If within limit â†’ 1.0x payout rate
    â””â”€â”€ If no individual limit â†’ Continue

Priority 3: Default Group Limits
    â”œâ”€â”€ If over group limit â†’ 0.5x payout rate, message: "à¸¡à¸µà¸¢à¸­à¸”à¸‹à¸·à¹‰à¸­à¹€à¸à¸´à¸™à¹‚à¸„à¸§à¸•à¹‰à¸²"
    â””â”€â”€ If within group limit â†’ 1.0x payout rate
```

### ğŸ² Field Types Supported
- **2_top** (2 à¸•à¸±à¸§à¸šà¸™) - 2-digit top lottery
- **2_bottom** (2 à¸•à¸±à¸§à¸¥à¹ˆà¸²à¸‡) - 2-digit bottom lottery  
- **3_top** (3 à¸•à¸±à¸§à¸šà¸™) - 3-digit top lottery
- **tote** (à¹‚à¸•à¹Šà¸”) - Tote betting

### ğŸ¯ Bulk Order Form Field Restrictions
- **à¹€à¸¥à¸‚ 2 à¸•à¸±à¸§**: à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸¥à¸·à¸­à¸ "à¸‹à¸·à¹‰à¸­à¸šà¸™" à¸«à¸£à¸·à¸­ "à¸‹à¸·à¹‰à¸­à¸¥à¹ˆà¸²à¸‡" à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ (à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸‹à¸·à¹‰à¸­à¹‚à¸•à¹Šà¸”à¹„à¸”à¹‰)
- **à¹€à¸¥à¸‚ 3 à¸•à¸±à¸§**: à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸¥à¸·à¸­à¸ "à¸‹à¸·à¹‰à¸­ 3 à¸•à¸±à¸§à¸šà¸™" à¸«à¸£à¸·à¸­ "à¸‹à¸·à¹‰à¸­à¹‚à¸•à¹Šà¸”" à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ (à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸‹à¸·à¹‰à¸­à¸¥à¹ˆà¸²à¸‡à¹„à¸”à¹‰)
- **à¸ˆà¸³à¸™à¸§à¸™à¸£à¸²à¸¢à¸à¸²à¸£**: à¸ªà¸¹à¸‡à¸ªà¸¸à¸” 20 à¸šà¸£à¸£à¸—à¸±à¸”à¸•à¹ˆà¸­à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­

### ğŸ’¾ Database Schema

#### à¸•à¸²à¸£à¸²à¸‡à¸«à¸¥à¸±à¸ (Core Tables)
```sql
-- User authentication
user                 
â”œâ”€â”€ id (PK)
â”œâ”€â”€ username (Unique)
â”œâ”€â”€ password_hash
â”œâ”€â”€ role (user/admin)
â””â”€â”€ is_active

-- Orders and order items with validation factors
order               
â”œâ”€â”€ id (PK)
â”œâ”€â”€ order_number (Unique)
â”œâ”€â”€ user_id (FK)
â”œâ”€â”€ customer_name
â”œâ”€â”€ total_amount
â”œâ”€â”€ status
â””â”€â”€ batch_id

order_item          
â”œâ”€â”€ id (PK)
â”œâ”€â”€ order_id (FK)
â”œâ”€â”€ number
â”œâ”€â”€ number_norm
â”œâ”€â”€ field
â”œâ”€â”€ amount
â”œâ”€â”€ validation_factor (NEW) -- 1.0 à¸«à¸£à¸·à¸­ 0.5
â”œâ”€â”€ validation_reason (NEW) -- à¹€à¸«à¸•à¸¸à¸œà¸¥à¸à¸²à¸£à¸›à¸£à¸±à¸šà¸­à¸±à¸•à¸£à¸²
â”œâ”€â”€ current_usage_at_time (NEW) -- à¸¢à¸­à¸”à¹ƒà¸Šà¹‰ à¸“ à¹€à¸§à¸¥à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š
â”œâ”€â”€ limit_at_time (NEW) -- à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸” à¸“ à¹€à¸§à¸¥à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š
â””â”€â”€ is_blocked

-- Rules for limits and payout rates (database-driven)
rule                
â”œâ”€â”€ id (PK)
â”œâ”€â”€ rule_type (limit/blocked/payout)
â”œâ”€â”€ field (2_top/2_bottom/3_top/tote)
â”œâ”€â”€ number_norm (NULL for defaults)
â”œâ”€â”€ value
â””â”€â”€ is_active

-- Blocked numbers
blocked_number      
â”œâ”€â”€ id (PK)
â”œâ”€â”€ number_norm
â”œâ”€â”€ field
â””â”€â”€ is_active

-- Usage tracking
number_total        
â”œâ”€â”€ id (PK)
â”œâ”€â”€ number_norm
â”œâ”€â”€ field
â”œâ”€â”€ total_amount
â””â”€â”€ last_updated

-- Audit logging
audit_log          
â”œâ”€â”€ id (PK)
â”œâ”€â”€ user_id (FK)
â”œâ”€â”€ action
â”œâ”€â”€ details
â””â”€â”€ timestamp
```

## ğŸš€ Quick Start

### Prerequisites
- Python 3.8+
- SQLite3 (included in Python)
- Flask and dependencies (see requirements.txt)

### Installation
```bash
# Clone repository
git clone https://github.com/SafetyDady/lotoryjung.git
cd lotoryjung_app

# Install dependencies
pip install -r requirements.txt

# Initialize database
flask db init
flask db migrate -m "Initial migration"
flask db upgrade

# Create default users and setup data
python -c "
from app import create_app, db
from app.models import User, Rule
app = create_app()
with app.app_context():
    # Create users
    admin = User(username='admin', name='Administrator', role='admin')
    admin.set_password('admin123')
    user = User(username='testuser', name='Test User', role='user')
    user.set_password('test123')
    db.session.add_all([admin, user])
    
    # Create default payout rates
    payout_rates = [
        Rule(rule_type='payout', field='2_top', value=90),
        Rule(rule_type='payout', field='2_bottom', value=90),
        Rule(rule_type='payout', field='3_top', value=900),
        Rule(rule_type='payout', field='tote', value=150)
    ]
    db.session.add_all(payout_rates)
    
    # Create default group limits
    default_limits = [
        Rule(rule_type='limit', field='2_top', value=1000),
        Rule(rule_type='limit', field='2_bottom', value=1000),
        Rule(rule_type='limit', field='3_top', value=500),
        Rule(rule_type='limit', field='tote', value=500)
    ]
    db.session.add_all(default_limits)
    
    db.session.commit()
    print('Database initialized successfully')
"

# Start server
python app.py
```

### Default Access
- **URL**: http://127.0.0.1:5002
- **Admin Login**: admin / admin123
- **Test User**: testuser / test123

## ğŸ“± User Interface Features

### ğŸ›ï¸ Bulk Order Form
- **URL**: `/bulk_order_form` (user login required)
- à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸«à¸¥à¸²à¸¢à¸£à¸²à¸¢à¸à¸²à¸£à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™ (à¸ªà¸¹à¸‡à¸ªà¸¸à¸” 20 à¸šà¸£à¸£à¸—à¸±à¸”)
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¹à¸šà¸š 2-à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™
- à¹à¸ªà¸”à¸‡à¸­à¸±à¸•à¸£à¸²à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢à¹à¸¥à¸°à¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¹à¸šà¸šà¹€à¸£à¸µà¸¢à¸¥à¹„à¸—à¸¡à¹Œ
- Field restrictions enforcement

### ğŸ¯ Single Order Form  
- **URL**: `/order` (user login required)
- à¸ªà¸±à¹ˆà¸‡à¸‹à¸·à¹‰à¸­à¸£à¸²à¸¢à¸à¸²à¸£à¹€à¸”à¸µà¸¢à¸§
- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¸µà¸”à¸ˆà¸³à¸à¸±à¸”à¸—à¸±à¸™à¸—à¸µ
- à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢à¹à¸šà¸šà¸—à¸±à¸™à¸—à¸µ

## ğŸ“± Admin Panel Features

### ğŸ  Dashboard
- System statistics overview
- Recent orders display
- Quick access buttons
- Performance metrics

### ğŸš« Blocked Numbers Management
- **URL**: `/admin/blocked_numbers`
- Bulk add/edit/delete operations
- Auto-permutation generation
- Search and filtering capabilities

### ğŸ“Š Group Limits Management  
- **URL**: `/admin/group_limits`
- Default limits configuration
- Real-time usage monitoring
- Visual progress indicators

### ğŸ¯ Individual Limits Management â­
- **URL**: `/admin/individual_limits`
- Granular number-specific limits
- Override default group limits
- Advanced filtering and search
- Modal-based CRUD operations

## ğŸ”§ API Endpoints

### Bulk Order Validation APIs (NEW) â­
```http
# Validate Bulk Order 
POST /api/validate_bulk_order
Content-Type: application/json
X-CSRFToken: <token>

{
    "orders": [
        {
            "rowId": "row_123456789",
            "number": "44",
            "amount_2_top": 100,
            "amount_2_bottom": 50,
            "amount_tote": 0
        }
    ]
}

# Response
{
    "success": true,
    "validation_results": [...],
    "summary": {
        "total_amount": 150,
        "estimated_payout": 13500,
        "normal_payout_items": 2,
        "reduced_payout_items": 0
    }
}

# Submit Bulk Order
POST /api/submit_bulk_order
Content-Type: application/json
X-CSRFToken: <token>

{
    "orders": [...],
    "customer_name": "à¸¥à¸¹à¸à¸„à¹‰à¸² A"
}

# Get Payout Rates
GET /api/get_payout_rates
```

### Individual Limits APIs
```http
# Set/Update Individual Limit
POST /admin/api/set_individual_limit
Content-Type: application/json
X-CSRFToken: <token>

{
    "field": "2_top",
    "number_norm": "12", 
    "limit_amount": 500
}

# Delete Individual Limit
POST /admin/api/delete_individual_limit
Content-Type: application/json
X-CSRFToken: <token>

{
    "field": "2_top",
    "number_norm": "12"
}
```

### Group Limits APIs
```http
# Update Group Limit
POST /admin/api/update_group_limit
Content-Type: application/json

{
    "field": "2_top",
    "limit": 1000000
}

# Get Dashboard Data
GET /admin/group_limits/api/dashboard_data?batch_id=20250902
```

## ğŸ¨ Frontend Technologies

- **Bootstrap 5.3.0** - UI framework
- **Font Awesome** - Icons
- **jQuery** - AJAX operations  
- **JavaScript ES6** - Modern JavaScript features
- **Jinja2** - Template engine

## ğŸ” Usage Examples

### Bulk Order Form Validation
```javascript
// JavaScript field validation example
function validateNumberAndToggleFields(inputElement) {
    const number = inputElement.value.trim();
    const row = inputElement.closest('tr');
    
    if (number.length === 2) {
        // Enable 2-digit fields, disable 3-digit/tote
        row.querySelector('[name="amount_2_top"]').disabled = false;
        row.querySelector('[name="amount_2_bottom"]').disabled = false;
        row.querySelector('[name="amount_3_top"]').disabled = true;
        row.querySelector('[name="amount_tote"]').disabled = true;
    } else if (number.length === 3) {
        // Enable 3-digit/tote fields, disable 2-digit bottom
        row.querySelector('[name="amount_2_top"]').disabled = true;
        row.querySelector('[name="amount_2_bottom"]').disabled = true;
        row.querySelector('[name="amount_3_top"]').disabled = false;
        row.querySelector('[name="amount_tote"]').disabled = false;
    }
}
```

### Adding Individual Limit
```python
from app.services.limit_service import LimitService

# Set limit of 500 for number "12" in 2_top category
success = LimitService.set_individual_limit("2_top", "12", 500)
```

### Validating Order with External Calculation Support
```python
# Validate order with validation factors for external calculation
result = LimitService.validate_order_item("2_top", "12", 300)
print(f"Validation factor: {result['validation_factor']}x")
print(f"Reason: {result['validation_reason']}")
print(f"Base payout rate: {result['base_payout_rate']}")
```

### Getting Current Usage
```python
# Get current usage for specific number
usage = LimitService.get_current_usage("2_top", "12", "20250902")
print(f"Current usage: {usage} à¸šà¸²à¸—")
```

## ğŸ“ˆ System Monitoring

### Performance Metrics
- Order processing speed
- Database query optimization
- Memory usage tracking
- Real-time user activity

### Audit Trail
- All admin actions logged
- User authentication tracking
- Limit changes monitoring
- System configuration changes

## ğŸ› ï¸ Development Tools

### Debugging Features
- Flask debug mode
- Server-side logging
- JavaScript console logging
- Database query monitoring

### Testing Capabilities
- Manual testing tools
- API endpoint testing
- Database integrity checks
- Security validation tests

## ğŸ“– Documentation

### Available Documents
- **[INDIVIDUAL_LIMITS_DESIGN.md](docs/INDIVIDUAL_LIMITS_DESIGN.md)** - Individual limits system design
- **[GROUP_LIMITS_DESIGN.md](docs/GROUP_LIMITS_DESIGN.md)** - Group limits system design  
- **[STRUCTURE.md](docs/STRUCTURE.md)** - Project structure overview
- **[PROGRESS.md](docs/PROGRESS.md)** - Development progress log
- **[INSTALLATION.md](docs/INSTALLATION.md)** - Installation guide

## ğŸš§ Future Enhancements

### Planned Features
- [ ] Mobile app API endpoints
- [ ] CSV/Excel export functionality
- [ ] Advanced analytics dashboard
- [ ] Multi-language support
- [ ] Bulk individual limits operations
- [ ] Time-based limit rules
- [ ] API rate limiting
- [ ] Real-time notifications

- SQL query profiling
- Error logging and monitoring
- Development environment setup

### Testing Framework
- Unit tests for service layer
- Integration tests for API endpoints
- Frontend validation testing
- Database migration testing

## ğŸš¦ Deployment

### Production Considerations
- **Environment Variables**: Configure production settings
- **Database**: Use PostgreSQL for production
- **Web Server**: Deploy with Gunicorn + Nginx
- **SSL Certificate**: Enable HTTPS for security
- **Backup Strategy**: Regular database backups

### Environment Setup
```bash
# Production environment variables
export FLASK_ENV=production
export SECRET_KEY=your-secret-key
export DATABASE_URL=postgresql://user:pass@localhost/lotoryjung
export ADMIN_EMAIL=admin@example.com
```

## ğŸ”® Future Roadmap

### Phase 1 Enhancements (Completed âœ…)
- âœ… Individual Number Limits Management System
- âœ… Bulk Order Form with 2-step Validation
- âœ… Database-driven Payout System
- âœ… Field Validation Logic
- âœ… External Calculation Support

### Phase 2 Enhancements (Planning)
- [ ] Real-time Notifications System
- [ ] Advanced Reporting & Analytics
- [ ] Mobile-responsive Design Improvements
- [ ] Multi-language Support
- [ ] API Rate Limiting

### System Improvements
- [ ] Database connection pooling
- [ ] Caching layer implementation (Redis)
- [ ] Background job processing (Celery)
- [ ] Microservices architecture
- [ ] Container deployment (Docker)

## ğŸ¤ Contributing

### Development Guidelines
1. Follow PEP 8 style guidelines
2. Write comprehensive tests
3. Update documentation
4. Use meaningful commit messages

### Code Structure
```
app/
â”œâ”€â”€ models.py           # Database layer
â”œâ”€â”€ services/
â”‚   â””â”€â”€ limit_service.py # Business logic
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.py         # Authentication
â”‚   â”œâ”€â”€ user.py         # User routes
â”‚   â”œâ”€â”€ admin.py        # Admin panel
â”‚   â””â”€â”€ api.py          # API endpoints
â”œâ”€â”€ templates/          # Jinja2 templates
â””â”€â”€ static/            # Frontend assets
```

### Contribution Process
1. Fork the repository
2. Create feature branch
3. Implement changes with tests
4. Update documentation
5. Submit pull request

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

## ğŸ†˜ Support & Troubleshooting

### Common Issues

#### CSRF Token Errors
```javascript
// Ensure AJAX requests include CSRF token
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", $('meta[name=csrf-token]').attr('content'));
        }
    }
});
```

#### Database Connection Issues
```bash
# Check database initialization
flask db current
flask db upgrade

# Reset database if needed
rm instance/app.db
flask db upgrade
```

#### Field Validation Problems
- Verify JavaScript validation functions
- Check field name attributes in HTML
- Ensure proper event listeners attachment

### Getting Help
- Check documentation thoroughly
- Review server logs: `tail -f logs/app.log`
- Test API endpoints with curl/Postman
- Verify database schema with DB browser

---

## ğŸ“Š System Status

**Current Version**: 2.0 (Individual Limits + Bulk Order Form)  
**Last Updated**: September 2, 2025  
**Status**: Production Ready âœ… All Features Operational

### Feature Completeness
- âœ… Order Management System
- âœ… Admin Dashboard
- âœ… Blocked Numbers Management
- âœ… Group Limits Management  
- âœ… Individual Number Limits â­
- âœ… Bulk Order Form System â­
- âœ… Database-driven Payout System â­
- âœ… 2-Step Validation Process â­
- âœ… Field Restrictions Logic â­
- âœ… External Calculation Support â­
- âœ… Message Text Updates ("à¸¡à¸µà¸¢à¸­à¸”à¸‹à¸·à¹‰à¸­à¹€à¸à¸´à¸™à¹‚à¸„à¸§à¸•à¹‰à¸²") â­

### Technical Specifications
- **Framework**: Flask 2.3+
- **Database**: SQLite (dev) / PostgreSQL (prod)
- **Frontend**: Bootstrap 5.3, jQuery, JavaScript ES6
- **Security**: CSRF Protection, Role-based Access
- **Architecture**: MVC with Service Layer Pattern

---

**ğŸ† à¸ªà¸³à¹€à¸£à¹‡à¸ˆà¹à¸¥à¹‰à¸§: Individual Limits + Bulk Order Form System à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™!**  
**ğŸ‘¨â€ğŸ’» à¸à¸±à¸’à¸™à¸²à¹‚à¸”à¸¢ SafetyDady | ğŸ“… September 2, 2025 | ğŸŒŸ Version 2.0**
- âœ… Order Management  
- âœ… Blocked Numbers Management
- âœ… Group Limits Management
- âœ… Individual Limits Management
- âœ… Admin Dashboard
- âœ… Security Implementation
- âœ… API Endpoints
- âœ… Documentation

**ğŸ‰ Ready for production use with comprehensive lottery management capabilities!**
